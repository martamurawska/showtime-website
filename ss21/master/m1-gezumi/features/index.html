<!DOCTYPE html>
<html lang="en" dir="ltr"><meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta charset="UTF-8">

<link rel="stylesheet" href="/showtime-website/css/style.min.0818788543d8a0321d579767df75923f6e671112d0dc29b6918c8a9379c61ac8.css" integrity="sha256-CBh4hUPYoDIdV5dn33WSP25nERLQ3Cm2kYyKk3nGGsg=" crossorigin="anonymous">


<script src=https://martamurawska.github.io/showtime-website/js/title-animate.js charset="utf-8"></script>
<script src=https://martamurawska.github.io/showtime-website/js/semester-select.js charset="utf-8"></script>
<script src=https://martamurawska.github.io/showtime-website/js/secret.js charset="utf-8"></script>
<title>IMI Showtime - HTW Berlin</title>
<body>
<nav class="background master">
    <a href="https://martamurawska.github.io/showtime-website/" class="animate-trigger"><strong>IMI<span class="light">×</span><span class="animate">ST</span></strong> <span class="light">






    
        2023
    

</span></a>
     
    <div class = "warn">Preview Site! 
        (with drafts)
      <div class = "warn small">Production Site: <a href="https://showtime.f4.htw-berlin.de/">https://showtime.f4.htw-berlin.de/</a></div>
    </div>  
    
    <ul>
        <li><a href="https://martamurawska.github.io/showtime-website/projects">Projects</a></li>
        <li><a href="https://martamurawska.github.io/showtime-website/schedule">Schedule</a></li>
        <li><a href="https://martamurawska.github.io/showtime-website/dates">Dates</a></li>
        
        
        
            
            
        
        <li><a href="/showtime-website/ws22">Archive</a></li>
        <li><a href="https://martamurawska.github.io/showtime-website/contact">Contact</a></li>
   </ul>
</nav>

    <div class="background master">
        <header class="project-header">
            <h1>
                <span class="type">M1 Master</span>
                GeZuMi
                <span class="underscore-spacer"> </span>
            </h1>
            <section style="text-align: right;">
                <div class="spacer"></div>
                
                    <h4>Team</h4>
                    <ul>
                        
                            <li>Samuel Günther</li>
                        
                            <li>Alain Ngoufack Nguefack</li>
                        
                            <li>Florian Reitz</li>
                        
                            <li>David Schach</li>
                        
                            <li>Lena Vollmer</li>
                        
                    </ul>
                
                
                    <h4>Supervision</h4>
                    Prof. Dr. Tobias Lenz
                
            </section>
        </header>
    </div>
    <div class="project-menu desktop-menu background master">
        <ul>
            <li ><a href="/showtime-website/ss21/master/m1-gezumi/">Overview</a></li>
            
            <li class="active"><a href="/showtime-website/ss21/master/m1-gezumi/features/">Features</a></li>
            
            <li ><a href="/showtime-website/ss21/master/m1-gezumi/process/">Process</a></li>
            
            <li ><a href="/showtime-website/ss21/master/m1-gezumi/tech-stack/">Tech Stack</a></li>
            
            <li ><a href="/showtime-website/ss21/master/m1-gezumi/future/">Future</a></li>
            
        </ul>
    </div>
    <div class="project-menu mobile-menu background master">
        <ul>
            <li ><a href="/showtime-website/ss21/master/m1-gezumi/">Overview</a></li>
            
            <li class="active"><a href="/showtime-website/ss21/master/m1-gezumi/features/">Features</a></li>
            
            <li ><a href="/showtime-website/ss21/master/m1-gezumi/process/">Process</a></li>
            
        </ul>
        <input type="checkbox" id="project-menu-button">
        <label for="project-menu-button">
            <span></span>
        </label>
        <div class="dropdown-menu">
            <ul>
                
                <li ><a href="/showtime-website/ss21/master/m1-gezumi/tech-stack/">Tech Stack</a></li>
                
                <li ><a href="/showtime-website/ss21/master/m1-gezumi/future/">Future</a></li>
                
            </ul>
        </div>
    </div>
    <main class="project">
        
        <p><section>
    <h3>
        
            Start and Client Screen
        
    </h3>
    <div class="spacer"></div>
    <div class="content">
        <h4 id="start-screen">Start Screen</h4>
<p>To help players understand which of the <strong>&lsquo;player-dots&rsquo;</strong> they represent on the <strong>game screen</strong> and to enable hosts to consciously build teams, all users are asked to provide a <strong>player name</strong> on the start screen of the app (see first screen below).</p>
<h4 id="join-requests">Join-Requests</h4>
<p>After choosing a player name and clicking &lsquo;Join Game&rsquo; on the start screen, users can <strong>scan for existing games and request to join</strong> one. After having been approved, the player will be see the game screen as soon as the host starts the game.</p>

    </div>
</section>



    
        
    
    
    


<figure>
    <img src="/showtime-website/ss21/master/m1-gezumi/client-flow.svg" alt="client user flow">

</figure>
</p>
<p><section>
    <h3>
        
            Host and Game Screen
        
    </h3>
    <div class="spacer"></div>
    <div class="content">
        <h4 id="game-setup">Game Setup</h4>
<p>After choosing their own player name and clicking &lsquo;Create Game&rsquo; on the start screen, the <strong>host</strong> is asked to decide on a <strong>game name</strong>. This will help players distinguish simultaneously played games during the join-request. The host can then <strong>approve players</strong>&rsquo; join-requests and <strong>start the game</strong> when the desired amount of players has been reached.</p>
<h4 id="game-screen">Game Screen</h4>
<p>After the host clicks &lsquo;Start Game&rsquo; all players are directed to the game screen.
To increase the challenge and make the game more fun to play, a few first gamification features were implemented:</p>
<ul>
<li><strong>Timer</strong>: Each game is played against the clock, the objective is to achieve the target shape as fast as possible. This enables players of different games to compare their times and success later on.</li>
<li>Quick &amp; <strong>easy</strong> new games: As soon as the target shape has been matched, the players can start the next round with a <strong>new shape</strong></li>
<li>Animation: The <strong>target shape is animated</strong> as soon as the players manage to reproduce it, to indicate that the game has been won</li>
</ul>

    </div>
</section>



    
        
    
    
    


<figure>
    <img src="/showtime-website/ss21/master/m1-gezumi/host-flow.svg" alt="host user flow">

</figure>
</p>
<section>
    <h3>
        
            How does this work?
        
    </h3>
    <div class="spacer"></div>
    <div class="content">
        <p>Three steps are implemented to display the positions of the players and the target figure.</p>
<ol>
<li>Distance Calculation</li>
<li>Position Determination</li>
<li>Shape Alignment</li>
</ol>

    </div>
</section>

<section>
    <h3>
        
            1. Distance Calculation
        
    </h3>
    <div class="spacer"></div>
    <div class="content">
        The first step is the <strong>distance calculation</strong> between the different players. This is done by using the <strong>bluetooth signal strength (RSSI)</strong>. The stronger the signal, the closer the devices are to each other. A well-known use-case of this solution is the Corona Warn App. Each device has a different transmission power that can be determined experimentally. If the transmission power is known, the distance can be calculated as follows:
    </div>
</section>

<script src="https://gist.github.com/lenavollmer/8021bb0bc10247d222fce63e3c8f61ef.js?file=DistanceCalculation.kt"></script>
<section>
    <h3>
        
            2. Position Estimation
        
    </h3>
    <div class="spacer"></div>
    <div class="content">
        <p>After the distances between all players are known, the player positions can be calculated. Only <strong>relative positions</strong> can be calculated from the distances. This means that the resulting triangle can be transformed by translation, rotation or reflection and would still match all the distances (<strong>congruence</strong>).</p>
<figure>
    <img src="/showtime-website/ss21/master/m1-gezumi/distance-to-position-1.svg" alt="Step 1 distances to positions">
</figure>
<p>The input is a distance matrix that describes the lengths of the sides of the triangle on the right. In the real game the matrix is not symmetrical because <strong>each distance is measured twice</strong> (from device A to B and from device B to A). These values are then averaged. Sometimes <strong>inconsistent distances</strong> are measured. This is the case when one side of the triangle is greater than the sum of the other two (<strong>triangle inequality</strong>). If that happens, the position estimation is canceled.</p>
<!-- erklären warum distanzmatrix, werte gemittelt etc. wenn invalide distanzen wird es abgebrochen -->
<figure>
    <img src="/showtime-website/ss21/master/m1-gezumi/distance-to-position-2.svg" alt="Step 2 distances to positions">
</figure>
<p>Player A is positioned at the origin of the coordinate system. Player B is positioned with the following assumptions:</p>
<ul>
<li>B shares the same y coordinate as A</li>
<li>B is to the right of A</li>
</ul>
<figure>
    <img src="/showtime-website/ss21/master/m1-gezumi/distance-to-position-3.svg" alt="Step 3 distances to positions">
</figure>
<p>Finally, the alpha angle can be calculated using the law of cosines. This in turn can be used to determine the x and y position of player C.</p>

    </div>
</section>

<section>
    <h3>
        
            3. Shape Alignment
        
    </h3>
    <div class="spacer"></div>
    <div class="content">
        <p>As the calculated player positions are <strong>relative</strong>, they need to be aligned to the target shape. As soon as the players&rsquo; positions and the positions of the target shape have the same distances between them, the shapes have to lie perfectly <strong>on top of each other</strong>.  This is done in three steps:</p>
<figure>
    <img src="/showtime-website/ss21/master/m1-gezumi/step-1.svg" alt="Step 1 Shape Alignment">
</figure>
<p>At first the position of player A is always <strong>translated</strong> to the &lsquo;first&rsquo; point of the target shape (Step 1).</p>
<figure>
    <img src="/showtime-website/ss21/master/m1-gezumi/step-2-3.svg" alt="Step 2 and 3 Shape Alignment">
</figure>
<p>In Step 2 the player shape is <strong>rotated</strong> so that the corresponding sides of the target and the player shape are parallel.</p>
<p>Finally, both shapes are <strong>centered</strong> independently on the game screen.</p>

    </div>
</section>

<section>
    <h3>
        
            Bluetooth Connection &amp; Sending of Data
        
    </h3>
    <div class="spacer"></div>
    <div class="content">
        <p><strong>Bluetooth Low Energy (BLE)</strong> is the foundation of GeZuMi. Throughout the app, the connection relies on a <strong>broadcasting approach</strong> that avoids having to pair all devices with each other, which would make the connection unstable, and a <strong>client-server-communication</strong> between clients and the host of the game.</p>
<p>Clients that have joined a game make themselves noticeable to other players via broadcasting and communicate with the host which provides updates of the game state. The <strong>Bluetooth packages</strong> that are broadcast by every player contain a game-specific identifier and some game data to be processed by all other players. Using the <strong>8-byte-game-identifier</strong> games running simultaneously at the same place can be differentiated. Through slight variations of the ID, devices can determine wether another device is a host or a client which is necessary for a consistent join process. Other <strong>game data</strong> included in these packages are a <strong>custom device identifier</strong> which is unique per device, a device name, the game name, and the device-specific transmission power value, for example. Due to the very limited size of the broadcast packages (around 20-25 bytes available for custom data), they could only contain the most important bits of information, and some <strong>filtering mechanisms</strong> had to be built in order to maximize the packages&rsquo; utility.</p>
<p>The broadcast packages can be received by other devices scanning the environment. This enables them to measure and calculate the distance to other players. Using direct client-server-connection, every client sends the measured and processed data to the <strong>host device</strong> which <strong>collects, joins and corrects all the data</strong>. The host is responsible for <strong>computing a valid game state</strong> (i.e. the positions of all players) and providing consistent game data to the clients. Clients and server communicate via the <strong>ATT (Attribute Protocol)</strong> data protocol. The host runs a <strong>game service</strong> that contains <strong>characteristics</strong>. The service as well as its characteristics are addressed using predefined 128-bit-UUIDs. The characteristics can be used by the clients for reading or writing data. The host is able to <strong>notify</strong> clients that have subscribed to a certain characteristic. The data is written in a serialized manner because of the limited number of bytes that can be transferred via a characteristic.</p>
<figure>
    <img src="/showtime-website/ss21/master/m1-gezumi/bluetooth.gif" alt="bluetooth network animation">
</figure>

    </div>
</section>


    </main>
<footer>
    <section>
        <a href="https://martamurawska.github.io/showtime-website/" class="animate-trigger"><strong>IMI<span class="light">⨯</span><span class="animate">ST</span></strong> 






    
        2023
    

</a>
        <ul>
            <li><a href="https://martamurawska.github.io/showtime-website/contact">Contact</a></li>
            <li><a href="https://martamurawska.github.io/showtime-website/privacy-policy">Privacy Policy</a></li>
            <li><a href="https://martamurawska.github.io/showtime-website/imprint">Imprint</a></li>
        </ul>
    </section>
    <img src="https://martamurawska.github.io/showtime-website/img/htw-logo.png" alt="HTW Logo">
</footer>
</body>
</html>
